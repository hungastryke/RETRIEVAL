$.fn.retrieval=function(c){configs={};configs.search=c.search;configs.posturl=c.posturl;configs.datanode=c.datanode;configs.datatype=(c.datatype==null?"json":c.datatype);configs.type=(c.type==null?"get":c.type);configs.image=(c.image==null?false:c.image);configs.imagenode=(c.imagenode==null?"":c.imagenode);configs.datanode=(c.datanode==null?"":c.datanode);configs.error=(c.error==null?"":c.error);configs.key=(c.key==null?"":c.key);var b=c.search.position();var a=b.left;var f=c.search.outerHeight()-7;var e=c.search.innerWidth();c.search.wrap('<div class="searchFilter"></div>');$(".searchFilter").append('<dl class="search"></dl>');$(".searchFilter dl").css({top:f,left:a,width:e});$(window).resize(function(){var l=c.search.position();var k=l.left;var n=c.search.outerHeight()-7;var m=c.search.outerWidth();$(".searchFilter dl").css({top:n,left:k,width:m})});var d=function(){c.search.addClass("keyOff")};var h=function(){$("dl.search").html("").removeClass("hide");c.search.removeClass("keyOff")};var g=$.extend({searchQuery:function(){c.search.keyup(function(){var k=function(){var l=c.search.val().toLowerCase();var m={};m[c.key]=l;$.ajax({url:c.posturl,dataType:c.datatype,type:c.type,data:m,success:function(o,n,p){$("dl.search").hide().html("");if(c.search.val()==""){$("dl.search").hide()}else{if(o.length===0){$("dl.search").show().html('<dd class="noEvent">There is no data available</dd>')}else{if(c.image){for(i=0;i<o.length;i++){if(o[i][c.datanode].toLowerCase().indexOf(l)!==-1){$("dl.search").show().append('<dd><img src="'+o[i][c.imagenode]+'" /><span>'+o[i][c.datanode]+"</span></dd>");$("dl.search dd:contains("+o[i][c.datanode]+")").slice(1).remove()}}}else{for(j=0;j<o.length;j++){if(o[j][c.datanode].toLowerCase().indexOf(l)!==-1){$("dl.search").show().append("<dd>"+o[j][c.datanode]+"</dd>");$("dl.search dd:contains("+o[j][c.datanode]+")").slice(1).remove()}}}}}},error:function(n,p,o){c.error}})};$(this).hasClass("keyOff")?"":k()}).keydown(function(k){if(k.keyCode==8){h()}if(k.keycode==13){c.search.trigger("keyup")}if((k.keyCode==38||k.keyCode==40)&&$("dl.search dd").length>0){if(k.keyCode==38){$("dl.search dd").hasClass("selected")?$("dl.search dd.selected").removeClass("selected").prev().addClass("selected"):$("dl.search dd:last-child").addClass("selected")}else{$("dl.search dd").hasClass("selected")?$("dl.search dd.selected").removeClass("selected").next().addClass("selected"):$("dl.search dd:first-child").addClass("selected")}d()}if($("dl.search dd.selected").length==0){c.search.removeClass("keyOff")}}).click(function(){h();c.search.trigger("keyup")}).blur(function(){$("dl.search").hide().html("")}).focus(function(){c.search.val()!=""?$(this).trigger("click"):$("dl search").hide().html("")})}},c);return this.each(function(){g.searchQuery()})};